<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="PlatformAutoReconciliationDao">

		<!-- 每日对账，清结算与业务线 数据分页 -->
		<select id="reconAutoReconciliationPage" parameterType="Dto" resultType="Dto">
		select 
		A.id_
		,B.name_
		,A.type_
		,A.reconciliation_date_
		,A.success_count
		,A.success_all_amount_
		,A.file_path_
		from fc_platform_reconciliation as A
		left join fc_platform as B on A.platform_id_ = B.id_
		WHERE
		1 = 1
		<!-- 归属业务线 -->
		<if test="platform_id_ != null and platform_id_ != ''">
			AND B.id_ = #{platform_id_}
		</if>
		<!-- 对账类型 -->
		<if test="type_ != null and type_ != ''">
			AND A.type_ = #{type_}
		</if>
		<!-- 对账日期开始时间 -->
		<if test="start_reconciliation_date_ != null and start_reconciliation_date_ != ''">
			AND A.reconciliation_date_ <![CDATA[ >= ]]> CONCAT(#{start_reconciliation_date_},' 00:00:00')
		</if>
		<!-- 对账日期结束时间 -->
		<if test="end_reconciliation_date_ != null and end_reconciliation_date_ != ''">
			AND A.reconciliation_date_ <![CDATA[ <= ]]> CONCAT(#{end_reconciliation_date_},' 23:59:59')
		</if>
		
		ORDER BY A.reconciliation_date_ DESC
		
	</select>
	
</mapper>