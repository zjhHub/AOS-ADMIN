<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="ReconPlatformReportDao">

		<!-- 获取划扣（代收）对账报表数据分页 -->
		<select id="reconFirstChargebackReportPage" parameterType="Dto" resultType="Dto">
		select 
			D.id_ as order_id_
			,A.id_ as accepted_id_
			,A.platform_id_
			,A.contract_id_
			,D.routed_third_channel_id_
			,D.third_channel_order_id_
			,D.chargeback_account_
			,D.chargeback_name_
			,D.chargeback_idcard_
			,D.chargeback_cellphone_
			,D.chargeback_amount_
			,E.request_time
			,E.response_time_
			,E.bank_echo_time_
		From fc_chargeback_order as D 
		left join fc_chargeback_accepted as A on D.chargeback_accepted_id_ = A.id_
		left join fc_chargeback_order_result as E on D.id_ = E.id_
		WHERE
		    <!-- 指令结果状态  成功-->
			E.order_result_status_ = 1
		<!-- 交易渠道 -->
		<if test="routed_third_channel_id_ != null and routed_third_channel_id_ != ''">
			AND D.routed_third_channel_id_ = #{routed_third_channel_id_}
		</if>
		<if test="platform_id_ != null and platform_id_ != ''">
			AND A.platform_id_ = #{platform_id_}
		</if>
		<!-- 渠道订单号 -->
		<if test="third_channel_order_id_ != null and third_channel_order_id_ != ''">
			AND D.third_channel_order_id_ = #{third_channel_order_id_}
		</if>
		<!-- 订单完成时段 -->
		<if test="start_response_time_ != null and start_response_time_ != ''">
			AND E.response_time_ <![CDATA[ >= ]]> CONCAT(#{start_response_time_},' 00:00:00')
		</if>
		<if test="end_response_time_ != null and end_response_time_ != ''">
			AND E.response_time_ <![CDATA[ <= ]]> CONCAT(#{end_response_time_},' 23:59:59')
		</if>
		ORDER BY D.id_ DESC
		
	</select>
	
	<!-- 获取划扣（代收）对账报表数据集合 -->
	<select id="reconChargebackReportList" parameterType="Dto" resultType="Dto">
		select 
			D.id_ as order_id_
			,A.id_ as accepted_id_
			,A.platform_id_
			,A.contract_id_
			,D.routed_third_channel_id_
			,D.third_channel_order_id_
			,D.chargeback_account_
			,D.chargeback_name_
			,D.chargeback_idcard_
			,D.chargeback_cellphone_
			,D.chargeback_amount_
			,E.request_time
			,E.response_time_
			,E.bank_echo_time_
		From fc_chargeback_order as D 
		left join fc_chargeback_accepted as A on D.chargeback_accepted_id_ = A.id_
		left join fc_chargeback_order_result as E on D.id_ = E.id_
		WHERE
		    <!-- 指令结果状态  成功-->
			E.order_result_status_ = 1
		<!-- 交易渠道 -->
		<if test="routed_third_channel_id_ != null and routed_third_channel_id_ != ''">
			AND D.routed_third_channel_id_ = #{routed_third_channel_id_}
		</if>
		<if test="platform_id_ != null and platform_id_ != ''">
			AND A.platform_id_ = #{platform_id_}
		</if>
		<!-- 渠道订单号 -->
		<if test="third_channel_order_id_ != null and third_channel_order_id_ != ''">
			AND D.third_channel_order_id_ = #{third_channel_order_id_}
		</if>
		<!-- 订单完成时段 -->
		<if test="start_response_time_ != null and start_response_time_ != ''">
			AND E.response_time_ <![CDATA[ >= ]]> CONCAT(#{start_response_time_},' 00:00:00')
		</if>
		<if test="end_response_time_ != null and end_response_time_ != ''">
			AND E.response_time_ <![CDATA[ <= ]]> CONCAT(#{end_response_time_},' 23:59:59')
		</if>
		ORDER BY D.id_ DESC
		
	</select>
	
	<select id="reconSecondChargebackReportPage" parameterType="Dto" resultType="Dto">
	
		select	
			D.id_ as order_id_
			,A.id_ as accepted_id_
			,A.platform_id_
			,A.contract_id_
			,D.routed_third_channel_id_
			,D.third_channel_order_id_
			,D.chargeback_account_
			,D.chargeback_name_
			,D.chargeback_idcard_
			,D.chargeback_cellphone_
			,D.chargeback_amount_
			,E.request_time
			,E.response_time_
			,E.bank_echo_time_
		From fc_chargeback_order as D 
		left join fc_chargeback_accepted as A on D.chargeback_accepted_id_ = A.id_
		left join fc_chargeback_order_result as E on D.id_ = E.id_
		WHERE
		E.order_result_status_ = 1
		<!-- 交易渠道 -->
		<if test="routed_third_channel_id_ != null and routed_third_channel_id_ != ''">
			AND A.routed_third_channel_id_ = #{routed_third_channel_id_}
		</if>
		<!-- 渠道订单号 -->
		<if test="third_channel_order_id_ != null and third_channel_order_id_ != ''">
			AND D.third_channel_order_id_ = #{third_channel_order_id_}
		</if>
		<!-- 订单完成时段 -->
		<if test="start_response_time_ != null and start_response_time_ != ''">
			AND E.response_time_ <![CDATA[ >= ]]> CONCAT(#{start_response_time_},' 00:00:00')
		</if>
		<if test="end_response_time_ != null and end_response_time_ != ''">
			AND E.response_time_ <![CDATA[ <= ]]> CONCAT(#{end_response_time_},' 23:59:59')
		</if>
		
		and A.contract_id_ = some(
			select 
			id_
			from fc_contract
			where 
			1 = 1
			<!-- 合同编码 -->
			<if test="contract_code_ != null and contract_code_ !='' "> 
				AND contract_code_ = #{contract_code_}
			</if>
			<!-- 展业途径 -->
			<if test="channel_ != null and channel_ != ''">
				AND channel_ like '%${channel_}%'
			</if>
			<!-- 产品名称 -->
			<if test="product_name_ != null and product_name_ !='' "> 
				AND product_name_ like '%${product_name_}%'
			</if>
			<!-- 合同编码 -->
			<if test="platform_id_ != null and platform_id_ !='' "> 
				AND platform_id_ = #{platform_id_}
			</if>
			<!-- TODO 借款人姓名 -->
			<if test="customer_name_ != null and customer_name_ != ''">
				AND customer_name_ like '%${customer_name_}%'
			</if>
			<!-- TODO 借款人身份证 -->
			<if test="customer_idcard_ != null and customer_idcard_ != ''">
				AND customer_idcard_ = #{customer_idcard_}
			</if>
		)
		
<!-- 		and A.contract_id_ in  -->
<!-- 		(249, 393, 412, 635, 1085, 1126, 1210, 1219, 1348, 1658, 1931, 2425, 2791, 3382, 3769, 3788, 3817, 3860, 3934, 3984, 4043, 4078, 4217, 4402, 4451, 4547, 4635, 4656, 4804, 5085, 5259, 5658, 5822, 6097, 6239, 6423, 6434, 6519, 6523, 6897, 6907, 7173, 7280, 7959, 8215, 8228, 8298, 8509, 8516, 8544, 8806, 9010, 9230, 9313, 9330, 9556, 9613, 9784, 10097, 10540, 10904, 10963, 11107, 11279, 11320, 11321, 11454, 11578, 11586, 11907, 11980, 11998, 12023, 12066, 12418, 12494, 12506, 12619, 12689, 12699, 12731, 12745, 12943, 13056, 13075, 13103, 13208, 13237, 13242, 13343, 13423, 13597, 13676, 13705, 14115, 14155, 14522, 14657, 15208, 15575, 15606, 15635, 15675, 15907, 16116, 16266, 16336, 16531, 16575, 16604, 16705, 16837, 17389, 17738, 17933, 18229, 18240, 18436, 18575, 18730, 19297, 19708, 19823, 20116, 20289, 20670, 20682, 20880, 20898, 20942, 20998, 21337, 21355, 21369, 21387, 21606, 22020, 22102, 22202, 22261, 22311, 22387, 22438, 22510, 22775, 22857, 22891, 23383, 23419, 23436, 23534, 23535, 23797, 23906, 24145, 24384, 24391, 24400, 24566, 25159, 25213, 25239, 25623, 25810, 25814, 25866, 26174, 26197, 26516, 26625, 26681, 26746, 26871, 26973, 27000, 27027, 27096, 27133, 27264, 27333, 27663, 27831, 27896, 27975, 28046, 28144, 28146, 28379, 28383, 28404, 28503, 28539, 28778, 28804, 28959, 28995, 29060, 29072, 29262, 29296, 29378, 29665, 29678, 29867, 29896, 29975, 30118, 30145, 30412, 30480, 30580, 30776, 30824, 31365, 31426, 31503, 31697, 31764, 31773, 31863, 32291, 32341, 32415, 32437, 32489, 32557, 32566, 32714, 32921, 32942, 33096, 33105, 33508, 34062, 34354, 34383, 34649, 34675, 34796, 34840, 34854, 35019, 35160, 35192, 35311, 35541, 35722, 35795, 35949, 35980, 36114, 36484, 36824, 37020, 37139, 37174, 37330, 37428, 37450, 37500, 37531, 37564, 37641, 37644, 38103, 38245, 38284, 38577, 38759, 38982, 39002, 39007, 39054, 39066, 39168, 39285, 39380, 39430, 39591, 40160, 40206, 40739, 40872, 40876, 40985, 41080, 41219, 41233, 41411, 41417, 41771, 42048, 42406, 42510, 42785, 43016, 43148, 43171, 43583, 43685, 43712, 43827, 44286, 44694, 44766, 44804, 44881, 45186, 45373, 45438, 45637, 45771, 46068, 46126, 46218, 46289, 46340, 46402, 46766, 47123, 47208, 47304, 47312, 47348, 47678, 48106, 48163, 48184, 48198, 48222, 48343, 48497, 48570, 48588, 49174, 49226, 49437, 49524, 49649, 49804, 49961, 49997, 50288, 50311, 50433, 50549, 50585, 50645, 50713, 51356, 51463, 51493, 51647, 51795, 51803, 51961, 52048, 52205, 52446, 52456, 52510, 52537, 52635, 52680, 52859, 53097, 53126, 53447, 53487, 53683, 53843, 54079, 54269, 54326, 54447, 54715, 54908, 55138, 55357, 55504, 55620, 55736, 55898, 56276, 56321, 56439, 56934, 57300, 57420, 57736, 57908, 57997, 58228, 58243, 58278, 58454, 58580, 59075, 59148, 59401, 59411, 59507, 59680, 60100, 60115, 60168, 60222, 60345, 60534, 61176, 61695, 61799, 61852, 62506, 62558, 62594, 62718, 62736, 62875, 62941, 63058, 63537, 63724, 63802, 64057, 64221, 64271, 64342, 64366, 64908, 64915, 65163, 65251, 65412, 65639, 65651, 65790, 65805, 65853, 65971, 66133, 66170, 66460, 66515, 66551, 66598, 66705, 66868, 66872, 67021, 67853, 67951, 68213, 68222, 68297, 68425, 68672, 68936, 69001, 69017, 69155, 69192, 69308, 69457, 69557, 69605, 69714, 69788, 69852, 70137, 70483, 70491, 70519, 70797, 70847, 70949, 71062, 71140, 71261, 71467, 71501, 71782, 71813, 71817, 71847, 72299, 72341, 72344, 72424, 72690, 72851, 73104, 73278, 73337, 73424, 73434, 73459, 73522, 73657, 73792, 73795, 73953, 74224, 74314, 74427, 74697, 74906, 74983, 74996, 74998, 75177, 75249, 75330, 75550, 75659, 75686, 75748, 75890, 76174, 76437, 76488, 76648, 76761, 76785, 76852, 77019, 77751, 78603, 78867, 78900, 78904, 79101, 79111, 79184, 79419, 79514, 79526, 79733, 79755, 79859, 80315, 80442, 80710, 81006, 81095, 81270, 81299, 81451, 82290, 82320, 82384, 82403, 82458, 82561, 82626, 82719, 82724, 82845, 82857, 83250, 83338, 83750, 83914, 83971, 84106, 84166, 84280, 84414, 84526, 84610, 85152, 85202, 85443, 85470, 85471, 85498, 85540, 85543, 85706, 85743, 85756, 85942, 86411, 86728, 86891, 87048, 87073, 87272, 87855, 87861, 88035, 88039, 88040, 88076, 88460, 88551, 88837, 88851, 89147) -->
<!-- 		<foreach collection="contractIdArray" item="item" -->
<!--              index="index" open="(" close=")" separator=","> -->
<!--              #{item, jdbcType=VARCHAR} -->
<!--        </foreach> -->
       
		order by D.id_ DESC
		
<!-- 		limit #{page} * #{limit}, #{limit} -->
	
	</select>
	
	<select id="reconSecondChargebackReportList" parameterType="Dto" resultType="Dto">
	
		select	
			D.id_ as order_id_
			,A.id_ as accepted_id_
			,A.platform_id_
			,A.contract_id_
			,D.routed_third_channel_id_
			,D.third_channel_order_id_
			,D.chargeback_account_
			,D.chargeback_name_
			,D.chargeback_idcard_
			,D.chargeback_cellphone_
			,D.chargeback_amount_
			,E.request_time
			,E.response_time_
			,E.bank_echo_time_
		From fc_chargeback_order as D 
		left join fc_chargeback_accepted as A on D.chargeback_accepted_id_ = A.id_
		left join fc_chargeback_order_result as E on D.id_ = E.id_
		WHERE
		E.order_result_status_ = 1
		<!-- 交易渠道 -->
		<if test="routed_third_channel_id_ != null and routed_third_channel_id_ != ''">
			AND A.routed_third_channel_id_ = #{routed_third_channel_id_}
		</if>
		<!-- 渠道订单号 -->
		<if test="third_channel_order_id_ != null and third_channel_order_id_ != ''">
			AND D.third_channel_order_id_ = #{third_channel_order_id_}
		</if>
		<!-- 订单完成时段 -->
		<if test="start_response_time_ != null and start_response_time_ != ''">
			AND E.response_time_ <![CDATA[ >= ]]> CONCAT(#{start_response_time_},' 00:00:00')
		</if>
		<if test="end_response_time_ != null and end_response_time_ != ''">
			AND E.response_time_ <![CDATA[ <= ]]> CONCAT(#{end_response_time_},' 23:59:59')
		</if>
		
		and A.contract_id_ = some(
			select 
			id_
			from fc_contract
			where 
			1 = 1
			<!-- 合同编码 -->
			<if test="contract_code_ != null and contract_code_ !='' "> 
				AND contract_code_ = #{contract_code_}
			</if>
			<!-- 展业途径 -->
			<if test="channel_ != null and channel_ != ''">
				AND channel_ like '%${channel_}%'
			</if>
			<!-- 产品名称 -->
			<if test="product_name_ != null and product_name_ !='' "> 
				AND product_name_ like '%${product_name_}%'
			</if>
			<!-- 合同编码 -->
			<if test="platform_id_ != null and platform_id_ !='' "> 
				AND platform_id_ = #{platform_id_}
			</if>
			<!-- TODO 借款人姓名 -->
			<if test="customer_name_ != null and customer_name_ != ''">
				AND customer_name_ like '%${customer_name_}%'
			</if>
			<!-- TODO 借款人身份证 -->
			<if test="customer_idcard_ != null and customer_idcard_ != ''">
				AND customer_idcard_ = #{customer_idcard_}
			</if>
		)
		
<!-- 		and A.contract_id_ in  -->
<!-- 		(249, 393, 412, 635, 1085, 1126, 1210, 1219, 1348, 1658, 1931, 2425, 2791, 3382, 3769, 3788, 3817, 3860, 3934, 3984, 4043, 4078, 4217, 4402, 4451, 4547, 4635, 4656, 4804, 5085, 5259, 5658, 5822, 6097, 6239, 6423, 6434, 6519, 6523, 6897, 6907, 7173, 7280, 7959, 8215, 8228, 8298, 8509, 8516, 8544, 8806, 9010, 9230, 9313, 9330, 9556, 9613, 9784, 10097, 10540, 10904, 10963, 11107, 11279, 11320, 11321, 11454, 11578, 11586, 11907, 11980, 11998, 12023, 12066, 12418, 12494, 12506, 12619, 12689, 12699, 12731, 12745, 12943, 13056, 13075, 13103, 13208, 13237, 13242, 13343, 13423, 13597, 13676, 13705, 14115, 14155, 14522, 14657, 15208, 15575, 15606, 15635, 15675, 15907, 16116, 16266, 16336, 16531, 16575, 16604, 16705, 16837, 17389, 17738, 17933, 18229, 18240, 18436, 18575, 18730, 19297, 19708, 19823, 20116, 20289, 20670, 20682, 20880, 20898, 20942, 20998, 21337, 21355, 21369, 21387, 21606, 22020, 22102, 22202, 22261, 22311, 22387, 22438, 22510, 22775, 22857, 22891, 23383, 23419, 23436, 23534, 23535, 23797, 23906, 24145, 24384, 24391, 24400, 24566, 25159, 25213, 25239, 25623, 25810, 25814, 25866, 26174, 26197, 26516, 26625, 26681, 26746, 26871, 26973, 27000, 27027, 27096, 27133, 27264, 27333, 27663, 27831, 27896, 27975, 28046, 28144, 28146, 28379, 28383, 28404, 28503, 28539, 28778, 28804, 28959, 28995, 29060, 29072, 29262, 29296, 29378, 29665, 29678, 29867, 29896, 29975, 30118, 30145, 30412, 30480, 30580, 30776, 30824, 31365, 31426, 31503, 31697, 31764, 31773, 31863, 32291, 32341, 32415, 32437, 32489, 32557, 32566, 32714, 32921, 32942, 33096, 33105, 33508, 34062, 34354, 34383, 34649, 34675, 34796, 34840, 34854, 35019, 35160, 35192, 35311, 35541, 35722, 35795, 35949, 35980, 36114, 36484, 36824, 37020, 37139, 37174, 37330, 37428, 37450, 37500, 37531, 37564, 37641, 37644, 38103, 38245, 38284, 38577, 38759, 38982, 39002, 39007, 39054, 39066, 39168, 39285, 39380, 39430, 39591, 40160, 40206, 40739, 40872, 40876, 40985, 41080, 41219, 41233, 41411, 41417, 41771, 42048, 42406, 42510, 42785, 43016, 43148, 43171, 43583, 43685, 43712, 43827, 44286, 44694, 44766, 44804, 44881, 45186, 45373, 45438, 45637, 45771, 46068, 46126, 46218, 46289, 46340, 46402, 46766, 47123, 47208, 47304, 47312, 47348, 47678, 48106, 48163, 48184, 48198, 48222, 48343, 48497, 48570, 48588, 49174, 49226, 49437, 49524, 49649, 49804, 49961, 49997, 50288, 50311, 50433, 50549, 50585, 50645, 50713, 51356, 51463, 51493, 51647, 51795, 51803, 51961, 52048, 52205, 52446, 52456, 52510, 52537, 52635, 52680, 52859, 53097, 53126, 53447, 53487, 53683, 53843, 54079, 54269, 54326, 54447, 54715, 54908, 55138, 55357, 55504, 55620, 55736, 55898, 56276, 56321, 56439, 56934, 57300, 57420, 57736, 57908, 57997, 58228, 58243, 58278, 58454, 58580, 59075, 59148, 59401, 59411, 59507, 59680, 60100, 60115, 60168, 60222, 60345, 60534, 61176, 61695, 61799, 61852, 62506, 62558, 62594, 62718, 62736, 62875, 62941, 63058, 63537, 63724, 63802, 64057, 64221, 64271, 64342, 64366, 64908, 64915, 65163, 65251, 65412, 65639, 65651, 65790, 65805, 65853, 65971, 66133, 66170, 66460, 66515, 66551, 66598, 66705, 66868, 66872, 67021, 67853, 67951, 68213, 68222, 68297, 68425, 68672, 68936, 69001, 69017, 69155, 69192, 69308, 69457, 69557, 69605, 69714, 69788, 69852, 70137, 70483, 70491, 70519, 70797, 70847, 70949, 71062, 71140, 71261, 71467, 71501, 71782, 71813, 71817, 71847, 72299, 72341, 72344, 72424, 72690, 72851, 73104, 73278, 73337, 73424, 73434, 73459, 73522, 73657, 73792, 73795, 73953, 74224, 74314, 74427, 74697, 74906, 74983, 74996, 74998, 75177, 75249, 75330, 75550, 75659, 75686, 75748, 75890, 76174, 76437, 76488, 76648, 76761, 76785, 76852, 77019, 77751, 78603, 78867, 78900, 78904, 79101, 79111, 79184, 79419, 79514, 79526, 79733, 79755, 79859, 80315, 80442, 80710, 81006, 81095, 81270, 81299, 81451, 82290, 82320, 82384, 82403, 82458, 82561, 82626, 82719, 82724, 82845, 82857, 83250, 83338, 83750, 83914, 83971, 84106, 84166, 84280, 84414, 84526, 84610, 85152, 85202, 85443, 85470, 85471, 85498, 85540, 85543, 85706, 85743, 85756, 85942, 86411, 86728, 86891, 87048, 87073, 87272, 87855, 87861, 88035, 88039, 88040, 88076, 88460, 88551, 88837, 88851, 89147) -->
<!-- 		<foreach collection="contractIdArray" item="item" -->
<!--              index="index" open="(" close=")" separator=","> -->
<!--              #{item, jdbcType=VARCHAR} -->
<!--        </foreach> -->
       
		order by D.id_ DESC
		
<!-- 		limit #{page} * #{limit}, #{limit} -->
	
	</select>
	
	<!-- 借款端，放款（代付）对账报表  分页  -->
	<select id="reconLoanAcceptedReportPage" parameterType="Dto" resultType="Dto">
	
	select 
	A.id_
	,A.platform_id_
	,A.contract_code_
	,D.channel_
	,D.customer_name_
	,D.customer_idcard_
	,D.customer_cellphone_
	,D.product_code_
	,D.product_name_
	,D.loan_pattern_
	,D.loan_staging_amount_
	,D.loan_staging_duration_
	,D.annualized_rate_
	,D.contract_amount_
	,A.routed_third_channel_id_
	,B.third_channel_order_id_
	,A.loan_account_
	,A.loan_name_
	,A.loan_idcard_
	,A.loan_cellphone_
	,A.loan_amount_
	,C.request_time
	,C.response_time_
	,C.bank_echo_time_
	from fc_loan_accepted_order as A
	left join fc_loan_order_send as B on A.id_ = B.loan_accepted_order_id_
	left join fc_loan_accepted_order_result as C on A.id_ = C.id_
	left join fc_contract as D on A.contract_id_ = D.id_
	where
		<!-- 指令结果状态  成功-->
		C.order_result_status_ =  1
		<!-- 交易渠道 -->
		<if test="routed_third_channel_id_ != null and routed_third_channel_id_ != ''">
			AND A.routed_third_channel_id_ = #{routed_third_channel_id_}
		</if>
		<!-- 借款合同编号 -->
		<if test="contract_code_ != null and contract_code_ != ''">
			AND A.contract_code_ = #{contract_code_}
		</if>
		<!-- 归属业务线 -->
		<if test="platform_id_ != null and platform_id_ != ''">
			AND A.platform_id_ = #{platform_id_}
		</if>
		<!-- 渠道订单号 -->
		<if test="third_channel_order_id_ != null and third_channel_order_id_ != ''">
			AND B.third_channel_order_id_ = #{third_channel_order_id_}
		</if>
		<!-- TODO 借款人姓名 -->
		<if test="customer_name_ != null and customer_name_ != ''">
			AND D.customer_name_ like '%${customer_name_}%'
		</if>
		<!-- TODO 借款人身份证 -->
		<if test="customer_idcard_ != null and customer_idcard_ != ''">
			AND D.customer_idcard_ = #{customer_idcard_}
		</if>
		<!-- 订单完成时段 -->
		<if test="start_response_time_ != null and start_response_time_ != ''">
			AND C.response_time_ <![CDATA[ >= ]]> CONCAT(#{start_response_time_},' 00:00:00')
		</if>
		<if test="end_response_time_ != null and end_response_time_ != ''">
			AND C.response_time_ <![CDATA[ <= ]]> CONCAT(#{end_response_time_},' 23:59:59')
		</if>
		<!-- 展业途径 -->
		<if test="channel_ != null and channel_ != ''">
			AND D.channel_ like '%${channel_}%'
		</if>
		<!-- 产品名称 -->
		<if test="product_name_ != null and product_name_ !='' "> 
			AND D.product_name_ like '%${product_name_}%'
		</if>
		ORDER BY D.id_ DESC
	
	</select>
	
	<!-- 根据条件获取合同信息列表 -->
	<select id="getContractIdList" parameterType="Dto" resultType="Fc_contractPO">

		select 
		*
		from fc_contract
		where 
		1 = 1
		<!-- 合同编码 -->
		<if test="contract_code_ != null and contract_code_ !='' "> 
			AND contract_code_ = #{contract_code_}
		</if>
		<!-- 展业途径 -->
		<if test="channel_ != null and channel_ != ''">
			AND channel_ like '%${channel_}%'
		</if>
		<!-- 产品名称 -->
		<if test="product_name_ != null and product_name_ !='' "> 
			AND product_name_ like '%${product_name_}%'
		</if>
		<!-- 合同编码 -->
		<if test="platform_id_ != null and platform_id_ !='' "> 
			AND platform_id_ = #{platform_id_}
		</if>
		<!-- TODO 借款人姓名 -->
		<if test="customer_name_ != null and customer_name_ != ''">
			AND customer_name_ like '%${customer_name_}%'
		</if>
		<!-- TODO 借款人身份证 -->
		<if test="customer_idcard_ != null and customer_idcard_ != ''">
			AND customer_idcard_ = #{customer_idcard_}
		</if>
	</select>
	
	
	<select id="reconLoanAcceptedReportList" parameterType="Dto" resultType="Dto">
	
	select 
	A.id_
	,A.platform_id_
	,A.contract_code_
	,D.channel_
	,D.customer_name_
	,D.customer_idcard_
	,D.customer_cellphone_
	,D.product_code_
	,D.product_name_
	,D.loan_pattern_
	,D.loan_staging_amount_
	,D.loan_staging_duration_
	,D.annualized_rate_
	,D.contract_amount_
	,A.routed_third_channel_id_
	,B.third_channel_order_id_
	,A.loan_account_
	,A.loan_name_
	,A.loan_idcard_
	,A.loan_cellphone_
	,A.loan_amount_
	,C.request_time
	,C.response_time_
	,C.bank_echo_time_
	from fc_loan_accepted_order as A
	left join fc_loan_order_send as B on A.id_ = B.loan_accepted_order_id_
	left join fc_loan_accepted_order_result as C on A.id_ = C.id_
	left join fc_contract as D on A.contract_id_ = D.id_
	where
		<!-- 指令结果状态  成功-->
		C.order_result_status_ =  1
		<!-- 交易渠道 -->
		<if test="routed_third_channel_id_ != null and routed_third_channel_id_ != ''">
			AND A.routed_third_channel_id_ = #{routed_third_channel_id_}
		</if>
		<!-- 借款合同编号 -->
		<if test="contract_code_ != null and contract_code_ != ''">
			AND A.contract_code_ = #{contract_code_}
		</if>
		<!-- 归属业务线 -->
		<if test="platform_id_ != null and platform_id_ != ''">
			AND A.platform_id_ = #{platform_id_}
		</if>
		<!-- 渠道订单号 -->
		<if test="third_channel_order_id_ != null and third_channel_order_id_ != ''">
			AND B.third_channel_order_id_ = #{third_channel_order_id_}
		</if>
		<!-- TODO 借款人姓名 -->
		<if test="customer_name_ != null and customer_name_ != ''">
			AND D.customer_name_ like '%${customer_name_}%'
		</if>
		<!-- TODO 借款人身份证 -->
		<if test="customer_idcard_ != null and customer_idcard_ != ''">
			AND D.customer_idcard_ = #{customer_idcard_}
		</if>
		<!-- 订单完成时段 -->
		<if test="start_response_time_ != null and start_response_time_ != ''">
			AND C.response_time_ <![CDATA[ >= ]]> CONCAT(#{start_response_time_},' 00:00:00')
		</if>
		<if test="end_response_time_ != null and end_response_time_ != ''">
			AND C.response_time_ <![CDATA[ <= ]]> CONCAT(#{end_response_time_},' 23:59:59')
		</if>
		<!-- 展业途径 -->
		<if test="channel_ != null and channel_ != ''">
			AND D.channel_ like '%${channel_}%'
		</if>
		<!-- 产品名称 -->
		<if test="product_name_ != null and product_name_ !='' "> 
			AND D.product_name_ like '%${product_name_}%'
		</if>
		ORDER BY D.id_ DESC
	
	</select>
	
	
</mapper>