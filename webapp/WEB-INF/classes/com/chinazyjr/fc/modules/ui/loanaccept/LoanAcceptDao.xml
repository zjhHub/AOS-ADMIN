<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="loanaccept">
	<select id="loanacceptPage" parameterType="Dto" resultType="Dto">
		SELECT
			fca.id_ AS chargeback_acceptedID,
			fca.request_id_,
			fca.location_,
			fca.contract_id_,
			fp.id_ AS platformId,
			fca.contract_code_,
			fca.loan_account_,
			fca.loan_name_,
			fca.loan_amount_,
			fca.created_time_,
			fp.name_ AS platformName,
			fcar.order_result_status_,
			fca.third_channel_order_id_,
			fca.routed_third_channel_id_
		FROM
			fc_loan_accepted_order fca
		LEFT JOIN fc_platform fp ON fca.platform_id_ = fp.id_
		LEFT JOIN fc_loan_accepted_order_result fcar ON fca.id_ = fcar.id_
		WHERE
			1 = 1
		<if test="chargeback_acceptedID != null and chargeback_acceptedID != ''">
			AND fca.id_ like '%${chargeback_acceptedID}%' <!--  -->
		</if>
		
		<if test="contract_id_ != null and contract_id_ != ''">
			AND fca.contract_id_ like '%${contract_id_}%'
		</if>
		
		<if test="request_id_ != null and request_id_ != ''">
			AND fca.request_id_ like '%${request_id_}%'
		</if>
		
		<if test="platformId != null and platformId != ''">
			AND fp.id_ = #{platformId}
		</if>
		
		<if test="location_ != null and location_ != ''">
			AND fca.location_ = #{location_}
		</if>

		<if test="contract_code_ != null and contract_code_ != ''">
			AND fca.contract_code_ like '%${contract_code_}%'
		</if>
		
		<if test="routed_third_channel_id_ != null and routed_third_channel_id_ != ''">
			AND fca.routed_third_channel_id_ = #{routed_third_channel_id_}
		</if>
		
		<if test="start_created_time_ != null and start_created_time_ !='' "> 
			AND fca.created_time_ <![CDATA[ >= ]]> #{start_created_time_}  <!-- 开始日期 -->
		</if>
		
		<if test="end_created_time_ != null and end_created_time_ !='' ">
			AND fca.created_time_ <![CDATA[ <= ]]> CONCAT(#{end_created_time_},' 23:59:59')  <!-- 结束日期 -->
		</if>
		<if test="third_channel_order_id_ != null and third_channel_order_id_ != ''">
			AND fca.third_channel_order_id_ = #{third_channel_order_id_}
		</if>
		
		ORDER BY fca.created_time_ DESC,fca.id_ DESC
		
	</select>
	
	<!-- 受理详情 -->
	<select id="loanacceptacceptDetails" parameterType="Dto" resultType="Dto">
	SELECT
<!-- 		<include refid="aos.fc.dao.Fc_loan_accepted_orderDao.column" />, -->
		fca.*,
		fcar.*, 
	<!-- 	<include refid="aos.fc.dao.Fc_loan_accepted_order_resultDao.column" />, -->
		fb.full_name_,
		fp.name_
		FROM
		fc_loan_accepted_order fca
	LEFT JOIN fc_loan_accepted_order_result fcar ON fca.id_ = fcar.id_
	LEFT JOIN fc_platform fp ON fca.platform_id_ = fp.id_
	LEFT JOIN fc_banks fb ON fb.id_ = fca.loan_bank_id_
	WHERE 1 = 1
		<if test="acceptedID != null and acceptedID !='' ">
			AND fca.id_ = #{acceptedID}
		</if>

	</select>
	
	
	
</mapper>